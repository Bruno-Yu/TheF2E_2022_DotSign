"use strict";(self["webpackChunkf2e_week2"]=self["webpackChunkf2e_week2"]||[]).push([[910],{9395:function(e,t,i){i.r(t),i.d(t,{default:function(){return We}});var a=i(3396),s=i(7139),n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEASURBVHgB7ZQxqsJAEIb/0VeaR163sxGeN9Aj6In0BsbO1qN4Ai29hQpq7ERIodU6I0RiEDUJ6fJBCDu7fLMZMgPUVI0xpvNuv4GCMLeHHAQnajTXbIO1tXb86lwTBbjLCFPnsCJg5oAriEZeq3WO43iFMqhcbuyYg0U6rmuJn7Lnc5VI5Q4Uys2X8gX9TFnm8vjM/F8owUMOmhyj/UDfuk6SEKEL5zZRFG2Rl6QsxrbDdFzXSble7ZeSJ1Qq/7Rfy0PkpVK5on+EyXRoWflXjfbUZIddiBx8TFBGrvxkA9LyvccgI/gyKXtF5crTuPa83z8R+qnQRcexzJ4paqriBruLepmgZqUsAAAAAElFTkSuQmCC",l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEpSURBVHgB7ZU/TsMwFMa/57KVQke77pAjdGULJ6BHYGXqGbgBnAC4QTlBV8aObA1DlGwg5DnmWSx2klqqUQfa/iRHsT/bz35/ZOC/M4iJSk0Xo9HwyhjzlqI7BKLYuYW4SdcBag9IKXMisWBpzOZnsG4frNF/vEC3Ai91WT6HU/zNtb4lMViBKLf+Obc0X+dvRhZPUk5zbEMpvVJqsvH7kltsvq8rrT95/dKfc9ZeZEGF133t+DAk1Busef1l1IBPVZUPf9EdAnumcwMizFTE71FcVjVhxvW6yCKNvnh1g8w5XVflNRLou/neY3AycHQGiL5coSEVQtYeCurANngkgbma6A1XW4Fd+H0bxtzu/eHgyTTmuzgfXnzwb4YdIdC7beiursslDoofuUNds3wgsp0AAAAASUVORK5CYII=",o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFTSURBVHgB7VVLTsMwEJ1xuwNBlq7SRbhBjtDeINwAlqy4Sm9AuQE9AXALlkXC2Dsi1LWHmQBWs8AfJBaVeIvI4/jN84ydF4BDB+4HWusForrm6YoU3Dpj1jlJYrwgoOv6AglueNgDUQ+IDXlcOvfyEE2e4AWB2ay+B6DG2tezIa7rNyAhwTYmAApa8NSPeJ4eOe4knoaFiD0/qxBLco4J4kA/7HrEI8DT8D6UqucLVMRV8I6RhYiTe7h0zqxjAine5Hvhbve+PT46eUYFnZRMpM550R0kUMyTs9DDeZThJ940jzznK0jdeNZvrLWrFFdBFgjpc3XLfW6pgJpVgbVGdrqSNkhyZ80SMpFZwe/x5wJZLdrDBgsJRQJfZ1GEUYvEFfmWNMg3RUwMMhHjBYHBFdVEPpRKXFEcUmwgmTzB+3fTcjflYYOAT/xXuipx01Le4eADKmzsRqLIXt0AAAAASUVORK5CYII=",r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACGSURBVHgB7ZKxCYAwEEV/1E7sDTqErVPoJq7iKpnA1tItskBqz6QTjeJhEcQ8CIG7+/zj+EAkNClnWMp6KIq8NcbMTzUJWFBPSDqOgmnAJxqENxDHgouiSwv86zQg+xMWbx+r0lqP+0p2HiJBuN/muv/yIFJWU2kfRxNT9AODjDmvBCJfYwO8CBdMuOc+VwAAAABJRU5ErkJggg==",d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABASURBVHgB7cqxDcAgDAXR7yhLIGWobMIqrMJU3gLTIiiQXN8rTycBwJXtoZSvSvErZXR3b2t5zykslGN6BAAJE9ZdCQjrVS37AAAAAElFTkSuQmCC",c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADnSURBVHgB7ZRNDoIwEIVn1APgrpYN3BBPAJ7AcAM9mWyA7uQCMraxJtMWQRJNWPAlJOV1Zvr3WoCVxXOQ8c183+o+O5gmmak7bODPjA4ghEhssws68aWxmEGCLbL76iYRXP04IioRMMfN1pzFW67apk55XLgCIv7XEeCpbevMD1NNUwBiCXx1bu7KQkBfcFxkrNjDRR/ycShZSpkTYqZdFllppotMIkImpCyCicTxWTusYMUHXRSsgGMukfG5bnZ6ZntvgLspTv0jVUpVn2qM3mSWGAWdduZjxScH+AXTrylRNUtfWRxPf8VVqQZ3+94AAAAASUVORK5CYII=";const u={class:"bg-n3 flex min-h-screen flex-col overflow-clip"},g={class:"flex grow w-full overflow-x-scroll"},h={class:"hidden w-1/5 shadow-md bg-white px-1 lg:block"},A={class:"flex flex-col grow"},b={class:"relative"},p=(0,a._)("img",{class:"inline-block mr-1",src:n,alt:"edit"},null,-1),f=(0,a._)("p",null,"簽名",-1),m=[p,f],v={class:"relative"},w=(0,a._)("img",{class:"inline-block mr-1",src:l,alt:"Calendar"},null,-1),x=(0,a._)("p",null,"日期",-1),y=[w,x],C={class:"relative"},k=(0,a._)("img",{class:"inline-block mr-1",src:o,alt:"text"},null,-1),_=(0,a._)("p",null,"文字",-1),B=[k,_],R={class:"relative w-full py-4 pl-4 lg:w-4/5"},U=(0,a._)("canvas",{class:"absolute drop-shadow-lg",id:"canvas"},null,-1),I={class:"flex items-center justify-center absolute left-8 top-6 z-10 rounded"},S={class:"inline-flex shadow-md hover:shadow-lg focus:shadow-lg",role:"group"},M=(0,a._)("img",{src:r,alt:"plus"},null,-1),D=[M],N=(0,a._)("img",{src:d,alt:"minus"},null,-1),P=[N],E=(0,a._)("img",{src:c,alt:"minimize"},null,-1),Y=[E],X={class:"flex items-center justify-center absolute right-8 top-6 z-10 rounded lg:hidden"},T={class:"inline-flex shadow-md hover:shadow-lg focus:shadow-lg",role:"group"},J=(0,a._)("img",{src:n,alt:"edit"},null,-1),j=[J],F=(0,a._)("img",{src:l,alt:"Calendar"},null,-1),L=[F],V=(0,a._)("img",{src:o,alt:"text"},null,-1),Q=[V],W={class:"fixed left-8 top-[470px] lg:left-0 lg:right-8 xl:top-auto xl:bottom-5 flex justify-end"},O={"aria-label":"Page navigation example"},Z={class:"inline-flex shadow-md hover:shadow-lg focus:shadow-lg",role:"group"},q=["disabled"],H=(0,a._)("span",{"aria-hidden":"true"},"«",-1),z=[H],G={disabled:"",type:"button",class:"rounded-l inline-block p-2.5 bg-n1 font-medium border border-n3 leading-tight transition duration-150 ease-in-out"},K=["disabled"],$=(0,a._)("span",{"aria-hidden":"true"},"»",-1),ee=[$];function te(e,t,i,n,l,o){const r=(0,a.up)("FunNav"),d=(0,a.up)("SignModal"),c=(0,a.up)("ModalNote");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",u,[(0,a.Wm)(r,{stage:2,onNext:o.confirmedEdit,onCancel:o.openModal},null,8,["onNext","onCancel"]),(0,a._)("div",g,[(0,a._)("div",h,[(0,a._)("ul",A,[(0,a._)("li",b,[(0,a._)("button",{type:"button",class:"flex w-full items-center whitespace-nowrap text-sm py-4 px-6 h-12 overflow-hidden text-ellipsis hover:text-gray-900 hover:bg-gray-100 transition duration-300 ease-in-out",onClick:t[0]||(t[0]=(...e)=>o.signOpen&&o.signOpen(...e))},m)]),(0,a._)("li",v,[(0,a._)("button",{type:"button",class:"flex w-full items-center whitespace-nowrap text-sm py-4 px-6 h-12 overflow-hidden text-ellipsis hover:text-gray-900 hover:bg-gray-100 transition duration-300 ease-in-out",onClick:t[1]||(t[1]=(...e)=>o.addDate&&o.addDate(...e))},y)]),(0,a._)("li",C,[(0,a._)("button",{type:"button",class:"flex w-full items-center whitespace-nowrap text-sm py-4 px-6 h-12 overflow-hidden text-ellipsis hover:text-gray-900 hover:bg-gray-100 transition duration-300 ease-in-out",onClick:t[2]||(t[2]=(...e)=>o.addText&&o.addText(...e))},B)])])]),(0,a._)("div",R,[U,(0,a._)("div",I,[(0,a._)("div",S,[(0,a._)("button",{type:"button",class:"rounded-l inline-block p-1.5 lg:p-2.5 bg-n1 font-medium border border-n3 text-xs leading-tight transition duration-150 ease-in-out",onClick:t[3]||(t[3]=(...e)=>o.scaleUp&&o.scaleUp(...e))},D),(0,a._)("button",{type:"button",class:"rounded-l inline-block p-1.5 lg:p-2.5 bg-n1 font-medium border border-n3 text-xs leading-tight transition duration-150 ease-in-out",onClick:t[4]||(t[4]=(...e)=>o.scaleDown&&o.scaleDown(...e))},P),(0,a._)("button",{type:"button",class:"rounded-l inline-block p-1.5 lg:p-2.5 bg-n1 font-medium border border-n3 text-xs leading-tight transition duration-150 ease-in-out",onClick:t[5]||(t[5]=(...e)=>o.clipMethod&&o.clipMethod(...e))},Y)])]),(0,a._)("div",X,[(0,a._)("div",T,[(0,a._)("button",{type:"button",class:"rounded-l inline-block p-1.5 lg:p-2.5 bg-n1 font-medium border border-n3 text-xs leading-tight transition duration-150 ease-in-out",onClick:t[6]||(t[6]=(...e)=>o.signOpen&&o.signOpen(...e))},j),(0,a._)("button",{type:"button",class:"rounded-l inline-block p-1.5 lg:p-2.5 bg-n1 font-medium border border-n3 text-xs leading-tight transition duration-150 ease-in-out",onClick:t[7]||(t[7]=(...e)=>o.addDate&&o.addDate(...e))},L),(0,a._)("button",{type:"button",class:"rounded-l inline-block p-1.5 lg:p-2.5 bg-n1 font-medium border border-n3 text-xs leading-tight transition duration-150 ease-in-out",onClick:t[8]||(t[8]=(...e)=>o.addText&&o.addText(...e))},Q)])]),(0,a._)("div",W,[(0,a._)("nav",O,[(0,a._)("div",Z,[(0,a._)("button",{disabled:l.currentNum<=1,type:"button","data-btn":"prevPage",class:"rounded-l inline-block p-2.5 bg-n1 font-medium border border-n3 leading-tight transition duration-150 ease-in-out","aria-label":"Previous",onClick:t[9]||(t[9]=(...e)=>o.switchPage&&o.switchPage(...e))},z,8,q),(0,a._)("button",G,(0,s.zw)(l.currentNum)+" / "+(0,s.zw)(l.totalNum),1),(0,a._)("button",{disabled:l.currentNum>=l.totalNum,"data-btn":"nextPage",type:"button",class:"rounded-l inline-block p-2.5 bg-n1 font-medium border border-n3 leading-tight transition duration-150 ease-in-out","aria-label":"Next",onClick:t[10]||(t[10]=(...e)=>o.switchPage&&o.switchPage(...e))},ee,8,K)])])])])])]),(0,a.Wm)(d,{ref:"signModal"},null,512),(0,a.Wm)(c,{ref:"modal",onCancel:o.hideModal},null,8,["onCancel"])],64)}i(7658);var ie=i(2578),ae=i(1848);const se={class:"modal fade fixed top-0 left-0 hidden w-full h-full outline-none overflow-x-hidden overflow-y-auto",id:"signModal",tabindex:"-1","aria-labelledby":"signModalTitle","aria-modal":"true",role:"dialog",ref:"modal"},ne={class:"modal-dialog modal-dialog-centered relative w-auto pointer-events-none"},le={class:"modal-content border-none shadow-lg relative flex flex-col w-full pointer-events-auto bg-white bg-clip-padding rounded-md outline-none text-current"},oe={class:"relative flex flex-shrink-0 items-center justify-center p-4 rounded-t-md"},re=(0,a._)("ul",{class:"nav nav-tabs nav-justified flex flex-wrap list-none pl-0 mb-2",id:"tabs-tabJustify",role:"tablist"},[(0,a._)("li",{class:"nav-item text-center",role:"presentation"},[(0,a._)("a",{href:"#tabs-homeJustify",class:"nav-link w-full whitespace-nowrap block font-medium text-xs leading-tight uppercase border-x-0 border-t-0 border-b-2 border-transparent px-6 py-3 my-2 hover:border-transparent hover:bg-gray-100 focus:border-transparent active",id:"tabs-home-tabJustify","data-bs-toggle":"pill","data-bs-target":"#tabs-homeJustify",role:"tab","aria-controls":"tabs-homeJustify","aria-selected":"true"},"簽名")]),(0,a._)("li",{class:"nav-item flex-grow text-center",role:"presentation"},[(0,a._)("a",{href:"#tabs-profileJustify",class:"nav-link w-full whitespace-nowrap block font-medium text-xs leading-tight uppercase border-x-0 border-t-0 border-b-2 border-transparent px-6 py-3 my-2 hover:border-transparent hover:bg-gray-100 focus:border-transparent",id:"tabs-profile-tabJustify","data-bs-toggle":"pill","data-bs-target":"#tabs-profileJustify",role:"tab","aria-controls":"tabs-profileJustify","aria-selected":"false"},"圖片")])],-1),de={class:"modal-body relative p-4"},ce={class:"tab-content",id:"tabs-tabContentJustify"},ue={class:"tab-pane fade show active",id:"tabs-homeJustify",role:"tabpanel","aria-labelledby":"tabs-home-tabJustify"},ge={key:0,class:"list-none"},he=["onClick"],Ae=["src","alt"],be={class:"tab-pane fade",id:"tabs-profileJustify",role:"tabpanel","aria-labelledby":"tabs-profile-tabJustify"},pe={class:"grid grid-cols-3 w-full h-auto gap-4"},fe={class:"rounded border-n6 w-full h-full flex justify-center items-center text-center"},me={class:"text-p1 text-lg d-block bg-n1 cursor-pointer",for:"img"},ve=["onClick"],we=["src","alt"],xe={class:"modal fade fixed top-0 left-0 hidden w-full h-full outline-none overflow-x-hidden overflow-y-auto",id:"createSignature",tabindex:"-1","aria-labelledby":"createSignature","aria-modal":"true",role:"dialog",ref:"signModal"},ye={class:"modal-dialog modal-dialog-centered relative w-auto pointer-events-none"},Ce={class:"modal-content border-none shadow-lg relative flex flex-col w-full pointer-events-auto bg-white bg-clip-padding rounded-md outline-none text-current"},ke={class:"flex w-full items-center justify-between p-4 rounded-t-md"},_e=(0,a._)("h5",{class:"text-xl font-medium leading-normal text-gray-800",id:"createSignatureLabel"}," 創建簽名 ",-1),Be=["disabled"],Re=(0,a._)("div",{class:"flex justify-end p-4 border-b border-gray-200"},[(0,a._)("div",{class:"rounded-full border-n6 border-[1.5px] text-center text-sm w-5 h-5 text-n6 align-top"}," ? ")],-1),Ue={class:"modal-body relative p-4"},Ie={class:"modal-footer flex flex-shrink-0 flex-wrap items-center p-4 border-t border-gray-200 rounded-b-md"},Se={class:"list-none flex space-x-2 items-center"},Me={class:"relative"},De={for:"pickColors",class:"w-3.5 h-3.5 text-n6 text-2xl block absolute -top-4 cursor-pointer"};function Ne(e,t,i,s,n,l){return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",null,[(0,a._)("div",se,[(0,a._)("div",ne,[(0,a._)("div",le,[(0,a._)("div",oe,[re,(0,a._)("button",{type:"button",class:"absolute right-4 top-4 btn-close box-content w-4 h-4 p-1 text-black border-none rounded-none opacity-50 focus:shadow-none focus:outline-none focus:opacity-100 hover:text-black hover:opacity-75 hover:no-underline","aria-label":"Close",onClick:t[0]||(t[0]=(...t)=>e.hideModal&&e.hideModal(...t))})]),(0,a._)("div",de,[(0,a._)("div",ce,[(0,a._)("div",ue,[e.signatures.length?((0,a.wg)(),(0,a.iD)("ul",ge,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.signatures,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{key:t},[(0,a._)("button",{type:"button","data-btn":"signature",onClick:t=>l.chooseSign(e)},[(0,a._)("img",{class:"show-img border",src:e,width:"300",height:"150",alt:t},null,8,Ae)],8,he)])))),128))])):(0,a.kq)("",!0),(0,a._)("button",{type:"button",class:"block w-full px-6 py-2.5 mt-4 mb-1 border border-p1 text-p1 font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-p1 hover:text-n1 transition duration-150 ease-in-out",onClick:t[1]||(t[1]=(...e)=>l.closeAndOpen&&l.closeAndOpen(...e))}," 創建簽名 + ")]),(0,a._)("div",be,[(0,a._)("ul",pe,[(0,a._)("li",null,[(0,a._)("div",fe,[(0,a._)("label",me,[(0,a.Uk)("選擇檔案 "),(0,a._)("input",{type:"file",id:"img",name:"img",class:"hidden",accept:"image/*","data-btn":"images",onChange:t[2]||(t[2]=(...e)=>l.saveImage&&l.saveImage(...e))},null,32)])])]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.images,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{key:t},[(0,a._)("button",{type:"button",class:"block w-full","data-btn":"images",onClick:t=>l.chooseSign(e)},[(0,a._)("img",{class:"w-full h-auto",src:e,alt:t},null,8,we)],8,ve)])))),128))])])])])])])],512)]),(0,a._)("div",xe,[(0,a._)("div",ye,[(0,a._)("div",Ce,[(0,a._)("div",ke,[(0,a._)("button",{type:"button",class:"btn-close block w-4 h-4 p-1 text-black border-none rounded-none opacity-50 focus:shadow-none focus:outline-none focus:opacity-100 hover:text-black hover:opacity-75 hover:no-underline",onClick:t[3]||(t[3]=(...t)=>e.signHide&&e.signHide(...t)),"aria-label":"Close"}),_e,(0,a._)("button",{disabled:n.use,type:"button",class:"block px-6 py-2.5 disabled:bg-n2 disabled:text-n5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out ml-1","data-btn":"signature",onClick:t[4]||(t[4]=(...e)=>l.saveImage&&l.saveImage(...e))}," 使用 ",8,Be)]),Re,(0,a._)("div",Ue,[(0,a._)("canvas",(0,a.dG)({id:"signature",height:"150",width:"440",class:"bg-n4"},(0,a.mx)({mousedown:l.startPosition,touchstart:l.startPosition,mousemove:l.draw,touchmove:l.draw,mouseup:l.finishedPosition,touchcancel:l.finishedPosition},!0)),null,16)]),(0,a._)("div",Ie,[(0,a._)("button",{type:"button",class:"inline-block clear px-1 py-2.5 mr-5 text-p1 font-medium text-xs leading-tight uppercase rounded transition duration-150 ease-in-out",onClick:t[5]||(t[5]=(...e)=>l.reset&&l.reset(...e))}," 清除 "),(0,a._)("ul",Se,[(0,a._)("li",null,[(0,a._)("button",{type:"button",class:"rounded-full w-3.5 h-3.5 bg-black active:ring-[1px] active:ring-yellow-300 active:ring-offset-2",onClick:t[6]||(t[6]=(...e)=>l.changeColor&&l.changeColor(...e))})]),(0,a._)("li",null,[(0,a._)("button",{type:"button",class:"rounded-full w-3.5 h-3.5 bg-p1 active:ring-[1px] active:ring-yellow-300 active:ring-offset-2",onClick:t[7]||(t[7]=(...e)=>l.changeColor&&l.changeColor(...e))})]),(0,a._)("li",null,[(0,a._)("button",{type:"button",class:"rounded-full w-3.5 h-3.5 bg-red-600 active:ring-[1px] active:ring-yellow-300 active:ring-offset-2",onClick:t[8]||(t[8]=(...e)=>l.changeColor&&l.changeColor(...e))})]),(0,a._)("li",Me,[(0,a._)("label",De,[(0,a.Uk)("+ "),(0,a._)("input",{type:"button",class:"hidden",id:"pickColors","on:colorChange":t[9]||(t[9]=(...e)=>l.changeColor&&l.changeColor(...e))},null,32)])])])])])])],512)],64)}var Pe=i(193),Ee={data(){return{fabric:null}},created(){this.fabric=fabric}},Ye={data(){return{isPainting:!1,picker:null,canvas:null,ctx:null,use:!0}},computed:{...(0,ie.Ah)(ae.c,["signatures","chosenSign","images"])},mixins:[Pe.Z,Ee],methods:{closeAndOpen(){this.hideModal(),this.signOpen()},changeColor(e){e.target.classList.contains("bg-p1")?this.ctx.strokeStyle="#3175FA":e.target.classList.contains("bg-red-600")?this.ctx.strokeStyle="#F64331":e.target.classList.contains("bg-black")?this.ctx.strokeStyle="#191A1B":this.ctx.strokeStyle=e.detail.color.hexa},getPaintPosition(e){const t=this.canvas.getBoundingClientRect();return"mousemove"===e.type?{x:e.clientX-t.left,y:e.clientY-t.top}:{x:e.touches[0].clientX-t.left,y:e.touches[0].clientY-t.top}},startPosition(e){this.use=!1,e.preventDefault(),this.isPainting=!0},finishedPosition(){this.isPainting=!1,this.ctx.beginPath()},draw(e){if(!this.isPainting)return;const t=this.getPaintPosition(e);this.ctx.lineTo(t.x,t.y),this.ctx.stroke()},reset(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.use=!0},saveImage(e){if("signature"===e.target.dataset.btn){const e=this.canvas.toDataURL("image/png");this.signatures.push(e),this.signHide(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.openModal()}else if("images"===e.target.dataset.btn){if(void 0===e.target.files[0])return;const t=e.target.files[0],i=URL.createObjectURL(t);this.images.push(i)}},chooseSign(e){this.fabric.Image.fromURL(e,(e=>{const t=e;t.top=100,t.scaleX=.5,t.scaleY=.5,this.chosenSign=t,this.hideModal()}))}},mounted(){this.canvas=document.querySelector("#signature"),this.picker=new ColorPicker(document.querySelector("#pickColors"),"#4c0082"),this.ctx=this.canvas.getContext("2d"),this.ctx.lineWidth=4,this.ctx.lineCap="round"}},Xe=i(89);const Te=(0,Xe.Z)(Ye,[["render",Ne]]);var Je=Te,je=i(4909),Fe=i(5132);pdfjsLib.GlobalWorkerOptions.workerSrc="https://mozilla.github.io/pdf.js/build/pdf.worker.js";var Le={data(){return{pdfjsLib:null}},created(){this.pdfjsLib=pdfjsLib}},Ve={data(){return{ctx:null,canvas:null,scale:1,currentNum:1,totalNum:1,offsetX:"",offsetY:"",clip_state:!1,userClipPath:null,pdfImage:null}},computed:{...(0,ie.rn)(ae.c,["pdfFile","chosenSign"]),...(0,ie.Ah)(ae.c,["ReName","tags","finalFile","signatures"])},mixins:[Le,Ee],watch:{chosenSign(e){this.canvas.add(e)}},components:{FunNav:Fe.Z,SignModal:Je,ModalNote:je.Z},methods:{switchPage(e){console.log("nextPage"===e.target.dataset.btn),"prevPage"===e.target.dataset.btn?this.currentNum-=1:"nextPage"===e.target.dataset.btn&&(this.currentNum+=1),this.renderAll()},async renderPDF(){const e=this.pdfFile,t=await this.pdfjsLib.getDocument(e).promise,i=await t.getPage(this.currentNum),a=i.getViewport({scale:window.devicePixelRatio}),s=document.createElement("canvas"),n=s.getContext("2d");s.width=a.width,s.height=a.height;const l=i.render({canvasContext:n,viewport:a});return l.promise.then((()=>s))},async pdfToImage(e){const t=1/window.devicePixelRatio;return new this.fabric.Image(e,{id:"renderPDF",scaleX:t,scaleY:t})},async renderAll(){this.canvas=new this.fabric.Canvas("canvas"),this.canvas.requestRenderAll();const e=await this.renderPDF();this.pdfImage=await this.pdfToImage(e),this.canvas.setWidth(this.pdfImage.width/window.devicePixelRatio),this.canvas.setHeight(this.pdfImage.height/window.devicePixelRatio),this.canvas.setBackgroundImage(this.pdfImage,this.canvas.renderAll.bind(this.canvas))},async getTotalNum(){const e=this.pdfFile,t=await this.pdfjsLib.getDocument(e).promise;this.totalNum=t.numPages},scaleUp(){this.scale+=.1,this.canvas.setDimensions({width:this.canvas.getWidth()*this.scale,height:this.canvas.getHeight()*this.scale}),this.canvas.setZoom(this.scale)},scaleDown(){this.scale-=.1,this.canvas.setDimensions({width:this.canvas.getWidth()*this.scale,height:this.canvas.getHeight()*this.scale}),this.canvas.setZoom(this.scale)},addText(){const e=new this.fabric.IText("雙擊我編輯",{left:0,top:120,hasControls:!0});this.canvas.add(e),this.canvas.setActiveObject(e),e.enterEditing(),e.selectAll()},addDate(){const e=(new Date).getFullYear(),t=(new Date).getMonth()+1,i=(new Date).getDate(),a=new this.fabric.Text(`${e}/${t}/${i}`,{left:0,top:120,hasControls:!0});this.canvas.add(a)},clipMethod(){this.clip_state=!this.clip_state,this.clip_state?this.clipConfirm():this.clipPath()},clipPath(){this.userClipPath=new this.fabric.Rect({width:200,height:200,fill:"rgb(178, 178, 178, 0.4)",transparentCorners:!1,cornerColor:"rgb(178, 178, 178, 0.8)",strokeWidth:1,cornerStrokeColor:"black",borderColor:"black",borderDashArray:[5,5],cornerStyle:"circle"}),this.userClipPath.setControlVisible("mtr",!1),this.canvas.add(this.userClipPath)},clipConfirm(){const e=this.userClipPath.getBoundingRect();this.canvas.setWidth(e.width),this.canvas.setHeight(e.height),this.pdfImage.set({cropX:e.left,cropY:e.top,width:e.width,height:e.height}),this.userClipPath.set({left:0,top:0}),this.userClipPath.setCoords(),this.userClipPath.opacity=0,this.canvas.renderAll()},confirmedEdit(){this.finalFile=this.canvas.toDataURL("image/png");const e={};if(e.file=`${this.finalFile}`,e.name=`${this.ReName}`,null===localStorage.getItem("historyFiles")){const t=[];t.push(e),localStorage.setItem("historyFiles",JSON.stringify(t))}else{const t=JSON.parse(localStorage.getItem("historyFiles"));t.push(e),localStorage.setItem("historyFiles",JSON.stringify(t))}this.$router.push("./final")},hideModal(){this.$refs.modal.hideModal()},openModal(){this.$refs.modal.openModal()},signOpen(){this.$refs.signModal.openModal()},signHide(){this.$refs.signModal.hideModal()}},mounted(){this.getTotalNum(),this.renderAll()}};const Qe=(0,Xe.Z)(Ve,[["render",te]]);var We=Qe}}]);
//# sourceMappingURL=910.19539185.js.map